import{c as e,p as t,q as s,L as i,_ as o}from"./lit-element-089a5717.js";import{q as n}from"./storybook-preview-9aba481c.js";import{_ as a}from"./tslib.es6-d9c764b6.js";import{i as r}from"./if-defined-f9b5fa5b.js";class c{constructor(){this.iconsetMap=new Map}static getInstance(){return c.instance||(c.instance=new c),c.instance}addIconset(e,t){this.iconsetMap.set(e,t);var s=new CustomEvent("sp-iconset-added",{bubbles:!0,composed:!0,detail:{name:e,iconset:t}});setTimeout(()=>window.dispatchEvent(s),0)}removeIconset(e){this.iconsetMap.delete(e);var t=new CustomEvent("sp-iconset-removed",{bubbles:!0,composed:!0,detail:{name:e}});setTimeout(()=>window.dispatchEvent(t),0)}getIconset(e){return this.iconsetMap.get(e)}}var l=e`:host{display:inline-block;color:inherit;fill:currentColor;pointer-events:none}:host(:not(:root)){overflow:hidden}:host([size=xxs]),:host([size=xxs]) img,:host([size=xxs]) svg{height:calc(var(--spectrum-alias-workflow-icon-size,
var(--spectrum-global-dimension-size-225))/2);width:calc(var(--spectrum-alias-workflow-icon-size,
var(--spectrum-global-dimension-size-225))/2)}:host([size=xs]),:host([size=xs]) img,:host([size=xs]) svg{height:calc(var(--spectrum-global-dimension-size-300)/2);width:calc(var(--spectrum-global-dimension-size-300)/2)}:host([size=s]),:host([size=s]) img,:host([size=s]) svg{height:var(--spectrum-alias-workflow-icon-size,var(--spectrum-global-dimension-size-225));width:var(--spectrum-alias-workflow-icon-size,var(--spectrum-global-dimension-size-225))}:host([size=m]),:host([size=m]) img,:host([size=m]) svg{height:var(--spectrum-global-dimension-size-300);width:var(--spectrum-global-dimension-size-300)}:host([size=l]),:host([size=l]) img,:host([size=l]) svg{height:calc(var(--spectrum-alias-workflow-icon-size,
var(--spectrum-global-dimension-size-225))*2);width:calc(var(--spectrum-alias-workflow-icon-size,
var(--spectrum-global-dimension-size-225))*2)}:host([size=xl]),:host([size=xl]) img,:host([size=xl]) svg{height:calc(var(--spectrum-global-dimension-size-300)*2);width:calc(var(--spectrum-global-dimension-size-300)*2)}:host([size=xxl]),:host([size=xxl]) img,:host([size=xxl]) svg{height:calc(var(--spectrum-global-dimension-size-300)*3);width:calc(var(--spectrum-global-dimension-size-300)*3)}#container{height:100%}img{height:auto}::slotted(*),img{width:100%;vertical-align:top}::slotted(*){height:100%}`;class d extends i{constructor(){super(...arguments),this.size="m",this.iconsetListener=e=>{if(this.name){var t=this.parseIcon(this.name);e.detail.name===t.iconset&&(this.updateIconPromise=this.updateIcon())}}}static get styles(){return[l]}connectedCallback(){super.connectedCallback(),window.addEventListener("sp-iconset-added",this.iconsetListener)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("sp-iconset-added",this.iconsetListener)}firstUpdated(){this.updateIconPromise=this.updateIcon()}attributeChangedCallback(e,t,s){super.attributeChangedCallback(e,t,s),this.updateIconPromise=this.updateIcon()}render(){return this.name?n` <div id="container"></div> `:this.src?n` <img src="${this.src}" alt="${r(this.label)}"> `:n` <slot></slot> `}updateIcon(){var e=this;return o((function*(){if(!e.name)return Promise.resolve();var t=e.parseIcon(e.name),s=c.getInstance().getIconset(t.iconset);return s&&e.iconContainer?(e.iconContainer.innerHTML="",s.applyIconToElement(e.iconContainer,t.icon,e.size,e.label?e.label:"")):Promise.resolve()}))()}parseIcon(e){var t=e.split(":"),s="default",i=e;return t.length>1&&(s=t[0],i=t[1]),{iconset:s,icon:i}}_getUpdateComplete(){var e=()=>super._getUpdateComplete,t=this;return o((function*(){yield e().call(t),yield t.updateIconPromise}))()}}d.is="sp-icon",a([t()],d.prototype,"src",void 0),a([t()],d.prototype,"name",void 0),a([t({reflect:!0})],d.prototype,"size",void 0),a([t()],d.prototype,"label",void 0),a([s("#container")],d.prototype,"iconContainer",void 0),customElements.get("sp-icon")||customElements.define("sp-icon",d);class h extends i{constructor(){super(...arguments),this.registered=!1,this.handleRemoved=({detail:e})=>{e.name===this.name&&(this.registered=!1,this.addIconset())}}firstUpdated(){this.style.display="none"}set name(e){this.registered&&(this._name&&c.getInstance().removeIconset(this._name),e&&c.getInstance().addIconset(e,this)),this._name=e}get name(){return this._name}connectedCallback(){super.connectedCallback(),this.addIconset(),window.addEventListener("sp-iconset-removed",this.handleRemoved)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("sp-iconset-removed",this.handleRemoved),this.removeIconset()}addIconset(){this.name&&!this.registered&&(c.getInstance().addIconset(this.name,this),this.registered=!0)}removeIconset(){this.name&&(c.getInstance().removeIconset(this.name),this.registered=!1)}}a([t()],h.prototype,"name",null);class p extends h{constructor(){super(...arguments),this.iconMap=new Map}updated(e){if(this.slotContainer){var t=this.getSVGNodes(this.slotContainer);this.updateSVG(t),super.updated(e)}}applyIconToElement(e,t,s,i){var n=this;return o((function*(){yield n.updateComplete;var s=n.iconMap.get(t);if(!s)throw new Error(`Unable to find icon ${t}`);var o=n.prepareSvgClone(s);o.setAttribute("role","img"),i?o.setAttribute("aria-label",i):o.setAttribute("aria-hidden","true"),e.shadowRoot?e.shadowRoot.appendChild(o):e.appendChild(o)}))()}getIconList(){return[...this.iconMap.keys()]}prepareSvgClone(e){var t=e.cloneNode(!0),s=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=t.getAttribute("viewBox")||"";for(s.style.cssText="pointer-events: none; display: block; width: 100%; height: 100%;",s.setAttribute("viewBox",i),s.setAttribute("preserveAspectRatio","xMidYMid meet"),s.setAttribute("focusable","false");t.childNodes.length>0;)s.appendChild(t.childNodes[0]);return s}getSVGIconName(e){return e}getSanitizedIconName(e){return e}renderDefaultContent(){return n``}render(){return n` <slot @slotchange="${this.onSlotChange}"> ${this.renderDefaultContent()} </slot> `}updateSVG(e){e.reduce((e,t)=>{var s=t.querySelectorAll("symbol");return e.push(...s),e},[]).forEach(e=>{this.iconMap.set(this.getSanitizedIconName(e.id),e)})}getSVGNodes(e){return e.assignedNodes({flatten:!0}).filter(e=>"svg"===e.nodeName)}onSlotChange(e){var t=e.target,s=this.getSVGNodes(t);this.updateSVG(s)}}a([s("slot")],p.prototype,"slotContainer",void 0);export{p as I};
//# sourceMappingURL=iconset-svg-7745673b.js.map
