System.register(["./_rollupPluginBabelHelpers-dd1c7cf9.js","./lit-html-c3c4c85b.js","./index-00e6e76a.js","./lit-element-d4673852.js","./tslib.es6-42b07a6d.js","./if-defined-20449433.js","./index-b3312fbd.js","./focusable-41626d58.js","./observe-slot-text-569de70c.js","./index-e717bb07.js","./index-bf6cccd2.js","./index-81133a3c.js","./index-6cf5744b.js"],(function(t){"use strict";var e,n,o,i,r,a,s,l,c,u,h,v,p,d,f,y,m;return{setters:[function(t){e=t.j,n=t.k,o=t.c,i=t._,r=t.d,a=t.e,s=t.a,l=t.f,c=t.l},function(t){u=t.h},function(t){h=t.e,v=t.l,p=t.m},function(t){d=t.c,f=t.p,y=t.L},function(t){m=t._},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){function g(){var t=e([":host{display:flex;flex-direction:column;width:100%;height:100%}"]);return g=function(){return t},t}var k=d(g()),b={bottom:"top",left:"left",right:"left",top:"top"},C={bottom:"top",left:"right",right:"left",top:"bottom"},O={left:"top",top:"left"},x={left:"width",top:"height"},E={};function w(t){var e,n,o=0,i=0,r={top:0,left:0};if("BODY"===t.tagName)e=window.innerWidth,n=window.innerHeight,t.ownerDocument?(r.top=t.ownerDocument.documentElement.scrollTop,r.left=t.ownerDocument.documentElement.scrollLeft):(r.top=t.scrollTop,r.left=t.scrollLeft);else{var a=t.getBoundingClientRect();e=a.width,n=a.height,o=a.top,i=a.left,r.top=t.scrollTop,r.left=t.scrollLeft}return{width:e,height:n,scroll:r,top:o,left:i}}function A(t,e,n,o,i){var r=o.scroll[t],a=o[x[t]],s=e-i-r,l=e+i-r+n;return s<0?-s:l>a?Math.max(a-l,-s):0}function S(t,e,n,o,i,r,a){var s=r.scroll[t],l=r[x[t]],c=a[t]+e-o-s,u=a[t]+e+o-s+n;return c<0&&("top"===i||"left"===i)||u>l&&("bottom"===i||"right"===i)}function L(t){if(E[t])return E[t];var e=t.split(" "),o=n(e,1)[0],i=t.split(" "),r=n(i,2)[1],a=b[o]||"right",s=O[a];b[r]||(r="center");var l=x[a],c=x[s];return E[t]={axis:a,crossAxis:s,crossPlacement:r,crossSize:c,placement:o,size:l},E[t]}function R(t,e,n,o,i,r){var a=o.axis,s=o.crossAxis,l=o.crossPlacement,c=o.crossSize,u=o.size,h=o.placement,v={top:0,left:0,bottom:0,right:0};if(v[s]=t[s]+r,"center"===l?v[s]+=(t[c]-n[c])/2:l!==s&&(v[s]+=t[c]-n[c]),t[c]<n[c]){var p=Math.min(v[s],t[s]);v[s]=Math.max(p,t[s]-n[c]+t[c])}return v[a]=h===a?t[a]-n[u]-i:t[a]+t[u]+i,v}function T(t,e){var n=t.getBoundingClientRect(),o=e.getBoundingClientRect();return{bottom:n.bottom-o.bottom,height:n.height,left:n.left-o.left,right:n.right-o.right,top:n.top-o.top,width:n.width,x:n.x,y:n.y}}function M(t,e,n,o,i,r,a,s,l){var c="BODY"===o.tagName,u=c?n.getBoundingClientRect():T(n,o);c||(u.top+=parseInt(n.style.marginTop,10)||0,u.left+=parseInt(n.style.marginLeft,10)||0);var h,v,p=e.getBoundingClientRect(),d={top:p.top,right:p.right,bottom:p.bottom,left:p.left,width:p.width,height:p.height,x:p.x,y:p.y},f=(h=e,v=window.getComputedStyle(h),{bottom:parseInt(v.marginBottom,10)||0,left:parseInt(v.marginLeft,10)||0,right:parseInt(v.marginRight,10)||0,top:parseInt(v.marginTop,10)||0});d.width+=f.left+f.right,d.height+=f.top+f.bottom;w(o);var y=o;return function(t,e,n,o,i,r,a,s,l,c,u){var h=L(t),v=h,p=v.axis,d=v.size,f=v.crossAxis,y=v.crossSize,m=v.placement,g=v.crossPlacement,k=R(n,0,o,h,c,u),b=c;if(a&&S(p,k[p],o[d],r,m,s,l)){var O=L("".concat(C[m]," ").concat(g)),x=O.axis,E=O.size,w=R(n,0,o,O,-1*c,u);S(x,w[x],o[E],r,C[m],s,l)||(h=O,k=w,b=-1*c)}var T=A(f,k[f],o[y],s,r);k[f]+=T;var M=Math.max(0,s.height+s.top+s.scroll.top-l.top-k.top-i.top-i.bottom-r);o.height=Math.min(o.height,M),T=T=A(f,(k=R(n,0,o,h,b,u))[f],o[y],s,r),k[f]+=T;var P={top:0,bottom:0,left:0,right:0};return P[f]=n[y]>o[y]?null:n[f]-k[f]+n[y]/2,{arrowOffsetLeft:P.left||0,arrowOffsetTop:P.top||0,maxHeight:M,placement:h.placement,positionLeft:k.left||0,positionTop:k.top||0}}(t,0,u,d,f,i,r,w(y),"BODY"===y.tagName?o.getBoundingClientRect():T(o,y),s,l)}function P(){var t=e(["@keyframes spOverlayFadeIn{0%{opacity:0;transform:var(--animation-transform)}to{opacity:1;transform:translate(0)}}@keyframes spOverlayFadeOut{0%{opacity:1;transform:translate(0)}to{opacity:0;transform:var(--animation-transform)}}:host{z-index:2;position:absolute;display:none;opacity:0;animation-duration:var(--spectrum-global-animation-duration-100);animation-timing-function:ease-in-out}:host([state]){display:block}:host([state=visible]){opacity:1;transform:translate(0)!important;visibility:visible;animation-name:spOverlayFadeIn}:host([state=hiding]){animation-name:spOverlayFadeOut}:host([placement=top]){--animation-transform:translateY(6px)}:host([placement=right]){--animation-transform:translate(-6px)}:host([placement=bottom]){--animation-transform:translateY(-6px)}:host([placement=left]){--animation-transform:translate(6px)}"]);return P=function(){return t},t}var F=d(P());function D(){var t=e([' <slot @slotchange="','" name="overlay"></slot> ']);return D=function(){return t},t}var j=function(){function t(){var e=this;i(this,t),this.promise=new Promise((function(t){return e.resolveFn=t}))}return s(t,[{key:"resolve",value:function(t){this.resolveFn&&this.resolveFn(t)}}]),t}(),z={containerPadding:10,crossOffset:0,flip:!0,offset:0,placement:"left"},B="spOverlayFadeOut",N={initial:"idle",states:{idle:{on:{active:"active"}},active:{on:{visible:"visible",hiding:"hiding",idle:"idle"}},visible:{on:{hiding:"hiding",idle:"idle"}},hiding:{on:{idle:"idle"}}}},I=function(t,e){return t?e&&N.states[t].on[e]||t:N.initial},H=function(t){function e(){var t;return i(this,e),(t=r(this,a(e).apply(this,arguments)))._state=I(),t.placement="bottom",t.offset=6,t.interaction="hover",t.positionAnimationFrame=0,t.onAnimationEnd=function(e){t.hiddenDeferred&&e.animationName===B&&t.hiddenDeferred.resolve()},t}return o(e,t),s(e,[{key:"open",value:function(t){var e=this;this.extractEventDetail(t),this.stealOverlayContent(t.detail.content),this.overlayContent&&(this.state="active",this.timeout=window.setTimeout((function(){e.state="visible",delete e.timeout}),t.detail.delay),this.hiddenDeferred=new j,this.addEventListener("animationend",this.onAnimationEnd),this.hiddenDeferred.promise.then((function(){e.removeEventListener("animationend",e.onAnimationEnd)})))}},{key:"extractEventDetail",value:function(t){this.overlayContent=t.detail.content,this.trigger=t.detail.trigger,this.placement=t.detail.placement,this.offset=t.detail.offset,this.interaction=t.detail.interaction}},{key:"dispose",value:function(){this.state="idle",this.timeout&&(clearTimeout(this.timeout),delete this.timeout),this.returnOverlayContent()}},{key:"stealOverlayContent",value:function(t){!this.placeholder&&t&&(this.placeholder||(this.placeholder=document.createComment("placeholder for "+t.nodeName)),t.parentElement&&t.parentElement.replaceChild(this.placeholder,t),this.overlayContent=t,this.overlayContent.setAttribute("slot","overlay"),this.appendChild(this.overlayContent))}},{key:"returnOverlayContent",value:function(){this.overlayContent&&(this.overlayContent.removeAttribute("slot"),this.placeholder&&this.placeholder.parentElement&&this.placeholder.parentElement.replaceChild(this.overlayContent,this.placeholder),delete this.placeholder)}},{key:"updateOverlayPosition",value:function(){if(this.trigger&&this.overlayContent&&this.hasSlotenOverlayContent&&this.root&&this.isConnected){var t={containerPadding:0,crossOffset:0,flip:!1,offset:this.offset,placement:this.placement},e=Object.assign(Object.assign({},z),t);this.position=M(e.placement,this.overlayContent,this.trigger,this.root,e.containerPadding,e.flip,this.root,e.offset,e.crossOffset),this.style.setProperty("left","".concat(this.position.positionLeft,"px")),this.style.setProperty("top","".concat(this.position.positionTop,"px"))}}},{key:"hide",value:function(){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state="hiding",!this.hiddenDeferred){t.next=3;break}return t.abrupt("return",this.hiddenDeferred.promise);case 3:case"end":return t.stop()}}),null,this)}},{key:"schedulePositionUpdate",value:function(){var t=this;cancelAnimationFrame(this.positionAnimationFrame),this.positionAnimationFrame=requestAnimationFrame((function(){return t.updateOverlayPosition()}))}},{key:"onSlotChange",value:function(){this.schedulePositionUpdate()}},{key:"connectedCallback",value:function(){l(a(e.prototype),"connectedCallback",this).call(this),this.schedulePositionUpdate()}},{key:"render",value:function(){return u(D(),this.onSlotChange)}},{key:"state",get:function(){return this._state},set:function(t){var e=I(this.state,t);e!==this.state&&(this._state=e,"idle"===this.state?this.removeAttribute("state"):this.setAttribute("state",this.state))}},{key:"hasSlotenOverlayContent",get:function(){return!(!this.overlayContent||this.overlayContent.parentElement!==this)}}],[{key:"create",value:function(t,n){var o=new e;return t.detail.content&&(o.root=n,o.open(t)),o}},{key:"styles",get:function(){return[F]}}]),e}(y);m([f()],H.prototype,"_state",void 0),m([f({reflect:!0})],H.prototype,"placement",void 0);var K=function(){function t(e,n){var o=this;i(this,t),this.overlays=[],this.preventMouseRootClose=!1,this.root=document.body,this.handlingResize=!1,this.handleMouseCapture=function(t){var e=o.topOverlay;if(t.target&&e&&e.overlayContent&&!function(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}(t)&&function(t){return 0===t.button}(t)){if(t.target instanceof Node){if(t.composedPath().indexOf(e.overlayContent)>=0)return void(o.preventMouseRootClose=!0);o.preventMouseRootClose=!1}}else o.preventMouseRootClose=!0},this.handleMouse=function(){o.preventMouseRootClose||o.closeTopOverlay()},this.handleKeyUp=function(t){"Escape"===t.key&&o.closeTopOverlay()},this.handleResize=function(){o.handlingResize||(o.handlingResize=!0,requestAnimationFrame((function(){o.overlays.forEach((function(t){t.updateOverlayPosition()})),o.handlingResize=!1})))},this.root=e,this.onChange=n,this.addEventListeners()}return s(t,[{key:"dispose",value:function(){this.removeEventListeners()}},{key:"addEventListeners",value:function(){this.document&&(this.document.addEventListener("click",this.handleMouseCapture,!0),this.document.addEventListener("click",this.handleMouse),this.document.addEventListener("keyup",this.handleKeyUp),window.addEventListener("resize",this.handleResize))}},{key:"removeEventListeners",value:function(){this.document&&(this.document.removeEventListener("click",this.handleMouseCapture,!0),this.document.removeEventListener("click",this.handleMouse),this.document.removeEventListener("keyup",this.handleKeyUp),window.removeEventListener("resize",this.handleResize))}},{key:"isOverlayActive",value:function(t){return!!this.overlays.find((function(e){return e.overlayContent===t}))}},{key:"isClickOverlayActiveForTrigger",value:function(t){return this.overlays.some((function(e){return e.trigger===t&&"click"===e.interaction}))}},{key:"openOverlay",value:function(t){var e=this;this.isOverlayActive(t.detail.content)||requestAnimationFrame((function(){var n=t.detail.interaction;if("click"===n)e.closeAllHoverOverlays();else if("hover"===n&&e.isClickOverlayActiveForTrigger(t.detail.trigger))return;var o=H.create(t,e.root);e.overlays.push(o),e.onChange(e.overlays)}))}},{key:"closeOverlay",value:function(t){var e=this;requestAnimationFrame((function(){var n=t.detail.content,o=e.overlays.find((function(t){return t.overlayContent===n}));e.hideAndCloseOverlay(o)}))}},{key:"closeAllHoverOverlays",value:function(){var t=!0,e=!1,n=void 0;try{for(var o,i=this.overlays[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var r=o.value;"hover"===r.interaction&&this.hideAndCloseOverlay(r)}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"hideAndCloseOverlay",value:function(t){var e;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=6;break}return n.next=3,regeneratorRuntime.awrap(t.hide());case 3:(e=this.overlays.indexOf(t))>=0&&(this.overlays[e].dispose(),this.overlays.splice(e,1)),this.onChange(this.overlays);case 6:case"end":return n.stop()}}),null,this)}},{key:"closeTopOverlay",value:function(){return this.hideAndCloseOverlay(this.topOverlay)}},{key:"document",get:function(){return this.root.ownerDocument||document}},{key:"topOverlay",get:function(){return this.overlays.slice(-1)[0]}}]),t}();function _(){var t=e([' <slot></slot> <slot name="overlays"></slot> ']);return _=function(){return t},t}var U=function(t){function e(){var t;return i(this,e),(t=r(this,a(e).call(this))).onOverlayStackChange=function(e){var n=new Set(e),o=!0,i=!1,r=void 0;try{for(var a,s=t.children[Symbol.iterator]();!(o=(a=s.next()).done);o=!0){var l=a.value;l instanceof H&&!n.has(l)&&t.removeChild(l)}}catch(t){i=!0,r=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}var u=!0,h=!1,v=void 0;try{for(var p,d=e[Symbol.iterator]();!(u=(p=d.next()).done);u=!0){var f=p.value;f.parentElement!==c(t)&&(f.setAttribute("slot","overlays"),t.appendChild(f))}}catch(t){h=!0,v=t}finally{try{u||null==d.return||d.return()}finally{if(h)throw v}}},t.overlayStack=new K(c(t),t.onOverlayStackChange),t}return o(e,t),s(e,[{key:"onOverlayOpen",value:function(t){this.overlayStack&&this.overlayStack.openOverlay(t)}},{key:"onOverlayClose",value:function(t){this.overlayStack&&this.overlayStack.closeOverlay(t)}},{key:"render",value:function(){return u(_())}},{key:"connectedCallback",value:function(){l(a(e.prototype),"connectedCallback",this).call(this),this.addEventListener("sp-overlay:open",this.onOverlayOpen),this.addEventListener("sp-overlay:close",this.onOverlayClose)}},{key:"disconnectedCallback",value:function(){this.removeEventListener("sp-overlay:open",this.onOverlayOpen),this.removeEventListener("sp-overlay:close",this.onOverlayClose),this.overlayStack&&this.overlayStack.dispose(),l(a(e.prototype),"disconnectedCallback",this).call(this)}}],[{key:"styles",get:function(){return[k]}}]),e}(y);function Y(){var t=e([":host([disabled]) #trigger{pointer-events:none}#overlay-content{display:none}"]);return Y=function(){return t},t}customElements.get("overlay-root")||customElements.define("overlay-root",U),customElements.get("active-overlay")||customElements.define("active-overlay",H);var q=d(Y());function W(){var t=e([' <div id="trigger" @click="','" @mouseenter="','" @mouseleave="','"> <slot name="trigger"></slot> </div> <div id="overlay-content"> <slot @slotchange="','" name="click-content"></slot> <slot @slotchange="','" name="hover-content"></slot> </div> ']);return W=function(){return t},t}var G=function(t){function e(){var t;return i(this,e),(t=r(this,a(e).apply(this,arguments))).placement="bottom",t.offset=6,t.disabled=!1,t}return o(e,t),s(e,[{key:"onOverlayOpen",value:function(t,e){var n="click"===e?this.clickContent:this.hoverContent,o=n?n.getAttribute("delay"):null,i=o?parseFloat(o):0;if(n){var r={content:n,delay:i,offset:this.offset,placement:this.placement,trigger:this,interaction:e},a=new CustomEvent("sp-overlay:open",{bubbles:!0,composed:!0,detail:r});this.dispatchEvent(a)}}},{key:"onOverlayClose",value:function(t,e){var n="click"===e?this.clickContent:this.hoverContent;if(n){var o=new CustomEvent("sp-overlay:close",{bubbles:!0,composed:!0,detail:{content:n}});this.dispatchEvent(o)}}},{key:"onTriggerClick",value:function(t){this.clickContent&&this.onOverlayOpen(t,"click")}},{key:"onTriggerMouseOver",value:function(t){this.hoverContent&&this.onOverlayOpen(t,"hover")}},{key:"onTriggerMouseLeave",value:function(t){this.hoverContent&&this.onOverlayClose(t,"hover")}},{key:"render",value:function(){return u(W(),this.onTriggerClick,this.onTriggerMouseOver,this.onTriggerMouseLeave,this.onClickSlotChange,this.onHoverSlotChange)}},{key:"onClickSlotChange",value:function(t){if(t.target){var e=t.target,n=this.extractSlotContent(e);n&&(this.clickContent=n)}}},{key:"onHoverSlotChange",value:function(t){if(t.target){var e=t.target,n=this.extractSlotContent(e);n&&(this.hoverContent=n)}}},{key:"extractSlotContent",value:function(t){var e=t.assignedNodes();return e.length?e[0]:null}}],[{key:"styles",get:function(){return[q]}}]),e}(y);function J(){var t=e(["\n        ","\n        <overlay-root>\n            <recursive-popover></recursive-popover>\n        </overlay-root>\n    "]);return J=function(){return t},t}function Q(){var t=e(["\n        ",'\n        <overlay-root>\n            <overlay-trigger\n                id="trigger"\n                placement="','"\n                offset="','"\n            >\n                <sp-button variant="primary" slot="trigger">\n                    Show Popover\n                </sp-button>\n                <sp-popover\n                    dialog\n                    slot="click-content"\n                    direction="','"\n                    tip\n                    open\n                >\n                    <div class="options-popover-content">\n                        <sp-slider\n                            value="5"\n                            step="0.5"\n                            min="0"\n                            max="20"\n                            label="Awesomeness"\n                        ></sp-slider>\n                        <div id="styled-div">\n                            The background of this div should be blue\n                        </div>\n                        <overlay-trigger id="inner-trigger" placement="bottom">\n                            <sp-button slot="trigger">Press Me</sp-button>\n                            <sp-popover\n                                dialog\n                                slot="click-content"\n                                direction="bottom"\n                                tip\n                                open\n                            >\n                                <div class="options-popover-content">\n                                    Another Popover\n                                </div>\n                            </sp-popover>\n\n                            <sp-tooltip\n                                slot="hover-content"\n                                delay="100"\n                                open\n                                tip="bottom"\n                            >\n                                Click to open another popover.\n                            </sp-tooltip>\n                        </overlay-trigger>\n                    </div>\n                </sp-popover>\n                <sp-tooltip open slot="hover-content" delay="100" tip="bottom">\n                    Click to open a popover.\n                </sp-tooltip>\n            </overlay-trigger>\n        </overlay-root>\n    ']);return Q=function(){return t},t}function V(){var t=e(["\n    <style>\n        overlay-root {\n            position: absolute;\n            top: 0;\n            right: 0;\n            bottom: 0;\n            left: 0;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n\n        overlay-trigger {\n            flex: none;\n        }\n\n        #styled-div {\n            background-color: blue;\n            color: white;\n            padding: 4px 10px;\n            margin-bottom: 10px;\n        }\n\n        #inner-trigger {\n            display: inline-block;\n        }\n    </style>\n"]);return V=function(){return t},t}function X(){var t=e([":host{text-align:center}sp-button{margin-top:11px}"]);return X=function(){return t},t}function Z(){var t=e(["\n                              <div>Maximum Depth</div>\n                          "]);return Z=function(){return t},t}function $(){var t=e(['\n                              <recursive-popover\n                                  position="','"\n                                  depth="','"\n                              ></recursive-popover>\n                          ']);return $=function(){return t},t}function tt(){var t=e(['\n            <sp-radio-group selected="','" name="group-example">\n                <sp-radio @change=',' value="top">\n                    Top\n                </sp-radio>\n                <sp-radio @change=',' value="right">\n                    Right\n                </sp-radio>\n                <sp-radio @change=',' value="bottom">\n                    Bottom\n                </sp-radio>\n                <sp-radio @change=',' value="left">\n                    Left\n                </sp-radio>\n            </sp-radio-group>\n            <overlay-trigger placement="','">\n                <sp-button slot="trigger" variant="cta">Open Popover</sp-button>\n                <sp-popover\n                    dialog\n                    slot="click-content"\n                    direction="','"\n                    tip\n                    open\n                >\n                    ',"\n                </sp-popover>\n            </overlay-trigger>\n        "]);return tt=function(){return t},t}m([f({reflect:!0})],G.prototype,"placement",void 0),m([f({type:Number,reflect:!0})],G.prototype,"offset",void 0),m([f({type:Boolean,reflect:!0})],G.prototype,"disabled",void 0),customElements.get("overlay-trigger")||customElements.define("overlay-trigger",G);var et=function(t){function e(){var t;return i(this,e),(t=r(this,a(e).call(this))).depth=0,t.placement="right",t.depth=0,t}return o(e,t),s(e,[{key:"onRadioChange",value:function(t){var e=t.target;this.placement=e.value}},{key:"render",value:function(){return h(tt(),this.placement,this.onRadioChange,this.onRadioChange,this.onRadioChange,this.onRadioChange,this.placement,this.placement,this.depth<7?h($(),this.placement,this.depth+1):h(Z()))}}],[{key:"styles",get:function(){return[d(X())]}}]),e}(y);m([f({type:String})],et.prototype,"placement",void 0),m([f({type:Number})],et.prototype,"depth",void 0),customElements.define("recursive-popover",et);var nt=h(V());t("default",{component:"overlay-root",title:"Overlay Root"}),t("Default",(function(){var t={top:"top",bottom:"bottom",left:"left",right:"right"},e=v("Type",t,t.bottom),n=p("Offset",6);return h(Q(),nt,e,n,e)}));t("deepNesting",(function(){return h(J(),nt)})).story={name:"Deep Nesting"}}}}));
//# sourceMappingURL=overlay-root.stories-82f9a277.js.map
